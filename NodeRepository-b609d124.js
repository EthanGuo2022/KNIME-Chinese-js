import{_ as N,ar as q,p as M,Z as L,b as h,o,d as r,w as y,j as p,as as O,at as z,c as u,a as g,t as P,g as I,n as $,u as j,v as G,au as Y,av as K,F as A,h as B,x as V,aw as Q,r as W,T as x,f as w,ax as Z,ay as J,az as X,aA as ee,ak as E,O as l,aB as te,Q as S,aC as oe,U as D,aD as se,aE as ae,G as U,aF as ne,a6 as le,aG as ie,aH as de,aI as re}from"./index-6dc36896.js";import{b as ce}from"./NodeDescription-22891d06.js";import{D as H}from"./DraggableNodeTemplate-762b6846.js";import{T as pe}from"./Tag-c0ba7798.js";import"./CloseButton-3f01b06f.js";import"./arrow-right-0785f3ac.js";import"./trash-c1de9387.js";const ue={components:{DraggableNodeTemplate:H,SearchResults:q},props:{displayMode:{type:String,default:"icon"}},emits:["showNodeDescription"],computed:{...M("nodeRepository",["nodes","query","selectedTags","selectedNode","totalNumFilteredNodesFound"]),searchScrollPosition:{get(){return this.$store.state.nodeRepository.searchScrollPosition},set(e){this.$store.commit("nodeRepository/setSearchScrollPosition",e)}},searchActions(){return{searchNodesNextPage:this.searchNodesNextPage}}},methods:{...L("nodeRepository",["searchNodesNextPage"])}};function me(e,t,s,_,c,a){const i=h("DraggableNodeTemplate"),d=h("SearchResults");return o(),r(d,{ref:"searchResults","search-scroll-position":a.searchScrollPosition,"onUpdate:searchScrollPosition":t[0]||(t[0]=n=>a.searchScrollPosition=n),"selected-node":e.selectedNode,"search-actions":a.searchActions,"selected-tags":e.selectedTags,"display-mode":s.displayMode,query:e.query,nodes:e.nodes,"num-filtered-out-nodes":e.totalNumFilteredNodesFound},{nodesTemplate:y(n=>[p(i,O(n,{onShowNodeDescription:m=>e.$emit("showNodeDescription",n)}),null,16,["onShowNodeDescription"])]),_:1},8,["search-scroll-position","selected-node","search-actions","selected-tags","display-mode","query","nodes","num-filtered-out-nodes"])}const ge=N(ue,[["render",me]]);const he=8,ye={components:{DraggableNodeTemplate:H,NodeList:z},props:{tag:{type:String,required:!0},nodes:{type:Array,default:()=>[]},displayMode:{type:String,default:"icon"},selectedNode:{type:[Object,null],required:!0}},emits:["selectTag","showNodeDescription"],computed:{hasMoreNodes(){return this.nodes.length>=he}}},_e=e=>(j("data-v-8e0ec988"),e=e(),G(),e),ve=_e(()=>g("hr",null,null,-1));function fe(e,t,s,_,c,a){const i=h("DraggableNodeTemplate"),d=h("NodeList");return o(),u("div",{class:$(["category",`display-${s.displayMode}`])},[g("div",null,[g("span",{class:"category-title",onClick:t[0]||(t[0]=n=>e.$emit("selectTag",s.tag))},P(s.tag),1),ve]),p(d,{nodes:s.nodes,class:"category-node-list","has-more-nodes":a.hasMoreNodes,"selected-node":s.selectedNode,"display-mode":s.displayMode,onShowMore:t[1]||(t[1]=n=>e.$emit("selectTag",s.tag))},{item:y(n=>[p(i,O(n,{onShowNodeDescription:m=>e.$emit("showNodeDescription",n)}),null,16,["onShowNodeDescription"])]),"more-button":y(()=>[I("Show all")]),_:1},8,["nodes","has-more-nodes","selected-node","display-mode"])],2)}const Se=N(ye,[["render",fe],["__scopeId","data-v-8e0ec988"]]);const Ne={components:{NodeCategory:Se,ScrollViewContainer:Y},props:{displayMode:{type:String,default:"icon"}},emits:["showNodeDescription"],computed:{...M("nodeRepository",["selectedNode","categoryScrollPosition","nodesPerCategory"])},methods:{...L("nodeRepository",["getAllNodes","setSelectedTags"]),...K("nodeRepository",["setCategoryScrollPosition"]),onScrollBottom(){this.getAllNodes({append:!0})},onSaveScrollPosition(e){this.setCategoryScrollPosition(e)},onSelectTag(e){this.setSelectedTags([e])}}},be={class:"content"};function Te(e,t,s,_,c,a){const i=h("NodeCategory"),d=h("ScrollViewContainer");return o(),r(d,{class:"results","initial-position":e.categoryScrollPosition,onScrollBottom:a.onScrollBottom,onSavePosition:a.onSaveScrollPosition},{default:y(()=>[g("div",be,[(o(!0),u(A,null,B(e.nodesPerCategory,({tag:n,nodes:m})=>(o(),r(i,{key:`tag-${n}`,class:"category",tag:n,nodes:m,"selected-node":e.selectedNode,"display-mode":s.displayMode,onSelectTag:a.onSelectTag,onShowNodeDescription:t[0]||(t[0]=T=>e.$emit("showNodeDescription",T))},null,8,["tag","nodes","selected-node","display-mode","onSelectTag"]))),128))])]),_:1},8,["initial-position","onScrollBottom","onSavePosition"])}const we=N(Ne,[["render",Te],["__scopeId","data-v-ca8b420f"]]),Re={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"#000","stroke-linejoin":"round",viewBox:"0 0 32 32"},Ce=g("path",{d:"m13.31 27.81 5.11-3.19v-9.15L28.95 4.19H3.05l10.26 11.28z"},null,-1),ke=[Ce];function Pe(e,t){return o(),u("svg",Re,ke)}const Ie={render:Pe},$e={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"#000","stroke-linejoin":"round",viewBox:"0 0 32 32"},Ae=g("path",{d:"M3 3h10.4v10.4H3zm15.6 0H29v10.4H18.6zM3 18.6h10.4V29H3zm15.6 0H29V29H18.6z"},null,-1),Ve=[Ae];function xe(e,t){return o(),u("svg",$e,Ve)}const De={render:xe},Me=5,Le=V({components:{Tag:pe},props:{numberOfInitialTags:{type:Number,default:Me},tags:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},showAll:{type:Boolean,default:!1}},emits:["update:modelValue","showMore"],computed:{sortedTags(){return[...this.modelValue.map(e=>({text:e,selected:!0})),...Q.difference(this.tags,this.modelValue).map(e=>({text:e,selected:!1}))]},shownTags(){return this.showAll?this.sortedTags:this.sortedTags.slice(0,this.numberOfInitialTags)},hasMoreTags(){return!this.showAll&&this.tags.length>this.numberOfInitialTags},allVisibleAreSelected(){return!this.showAll&&this.modelValue.length>this.numberOfInitialTags},moreDisplayText(){let e=this.tags.length-this.numberOfInitialTags;return this.allVisibleAreSelected?`+${this.modelValue.length-this.numberOfInitialTags}/${e}`:`+${e}`}},methods:{onClick(e){e.selected?this.$emit("update:modelValue",this.modelValue.filter(t=>t!==e.text)):this.$emit("update:modelValue",[...this.modelValue,e.text])},onShowMore(){this.$emit("showMore")}}});function Oe(e,t,s,_,c,a){const i=h("Tag");return e.shownTags.length?(o(),u("div",{key:0,class:$(["wrapper",{"show-all":e.showAll}])},[(o(!0),u(A,null,B(e.shownTags,d=>(o(),r(i,{key:d.text,clickable:"",class:$({selected:d.selected}),onClick:x(n=>e.onClick(d),["prevent"])},{default:y(()=>[I(P(d.text)+" ",1),W(e.$slots,"icon",{},void 0,!0)]),_:2},1032,["class","onClick"]))),128)),e.hasMoreTags?(o(),r(i,{key:0,class:"more-tags clickable",onClick:x(e.onShowMore,["prevent","stop"])},{default:y(()=>[I(P(e.moreDisplayText),1)]),_:1},8,["onClick"])):w("",!0)],2)):w("",!0)}const Be=N(Le,[["render",Oe],["__scopeId","data-v-5919330c"]]);const Ee=31,Ue=1,He=10,Fe=1,qe={components:{SelectableTagList:Be,ClosePopoverIcon:Z},mixins:[J],props:{tags:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],data(){return{displayAll:!1}},computed:{numberOfInitialTags(){let e=Ee*Ue,t=0;for(let s of this.tags)if(e-=s.length,e>0)t++;else break;return Math.min(Math.max(t,Fe),He)}},methods:{onUpdateModelValue(e){this.displayAll=!1,this.$emit("update:modelValue",e)},onClickAway(){this.displayAll=!1}}},ze={class:"closeable-tags"},je={class:"popout"};function Ge(e,t,s,_,c,a){const i=h("SelectableTagList"),d=h("ClosePopoverIcon"),n=X("click-away");return ee((o(),u("div",ze,[g("div",je,[p(i,{ref:"tagList","number-of-initial-tags":a.numberOfInitialTags,"model-value":s.modelValue,tags:s.tags,"show-all":c.displayAll,onShowMore:t[0]||(t[0]=m=>c.displayAll=!0),"onUpdate:modelValue":a.onUpdateModelValue},null,8,["number-of-initial-tags","model-value","tags","show-all","onUpdate:modelValue"]),c.displayAll?(o(),u("button",{key:0,class:"tags-popout-close",onClick:t[1]||(t[1]=m=>c.displayAll=!1)},[p(d)])):w("",!0)])])),[[n,a.onClickAway]])}const Ye=N(qe,[["render",Ge],["__scopeId","data-v-776d17e2"]]),Ke={class:"header"},Qe={class:"title-and-search"},We={class:"search-header",style:{"margin-bottom":"8px"}},Ze={class:"view-settings"},Je=V({__name:"NodeRepositoryHeader",setup(e){const t=E(),s=l(()=>t.getters["nodeRepository/searchIsActive"]),_=l(()=>t.getters["nodeRepository/tagsOfVisibleNodes"]),c=l(()=>t.state.settings.settings.nodeRepositoryDisplayMode),a=l(()=>t.state.application.hasNodeCollectionActive),i=l(()=>t.state.application.nodeRepositoryLoaded),d=l({get(){return t.state.nodeRepository.selectedTags},set(f){t.dispatch("nodeRepository/setSelectedTags",f)}}),n=l(()=>s.value?[{text:"Nodes",id:"clear"},{text:"Results"}]:[{text:"Nodes"}]),m=f=>{f.id==="clear"&&t.dispatch("nodeRepository/clearSearchParams")},T=()=>{t.dispatch("settings/updateSetting",{key:"nodeRepositoryDisplayMode",value:c.value==="list"?"icon":"list"})},k=()=>{U.desktop.openWebUIPreferencePage()};return(f,v)=>(o(),u("div",Ke,[g("div",Qe,[g("div",We,[p(te,{items:n.value,class:"repo-breadcrumb",onClick:m},null,8,["items"]),g("div",Ze,[p(D,{class:"list-view-button",title:"Switch between icon and list view",disabled:!i.value,onClick:T},{default:y(()=>[c.value==="list"?(o(),r(S(De),{key:0,class:"list-icon"})):(o(),r(S(oe),{key:1,class:"list-icon"}))]),_:1},8,["disabled"]),p(D,{class:"filter-button",title:"Open search filters",disabled:!i.value,onClick:k},{default:y(()=>[a.value?(o(),r(S(se),{key:0,class:"filter-icon"})):(o(),r(S(Ie),{key:1,class:"filter-icon"}))]),_:1},8,["disabled"])])]),p(ae,{"model-value":S(t).state.nodeRepository.query,disabled:!i.value,placeholder:a.value?"Search starter nodes":"Search all nodes",class:"search-bar",onClear:v[0]||(v[0]=b=>S(t).dispatch("nodeRepository/clearSearchParams")),"onUpdate:modelValue":v[1]||(v[1]=b=>S(t).dispatch("nodeRepository/updateQuery",b))},null,8,["model-value","disabled","placeholder"])]),s.value&&_.value.length?(o(),r(Ye,{key:0,modelValue:d.value,"onUpdate:modelValue":v[2]||(v[2]=b=>d.value=b),tags:_.value},null,8,["modelValue","tags"])):w("",!0)]))}});const Xe=N(Je,[["__scopeId","data-v-ad0ab1fe"]]),et={class:"node-repo"},tt=50,ot=V({__name:"NodeRepository",setup(e){const t=E(),s=l(()=>t.state.nodeRepository.nodesPerCategory),_=l(()=>t.state.nodeRepository.selectedNode),c=l(()=>t.getters["nodeRepository/searchIsActive"]),a=l(()=>t.getters["nodeRepository/isSelectedNodeVisible"]),i=l(()=>t.state.settings.settings.nodeRepositoryDisplayMode),d=l(()=>t.state.application.activeProjectId),n=l(()=>t.state.application.nodeRepositoryLoaded),m=l(()=>t.state.application.nodeRepositoryLoadingProgress),T=l(()=>t.state.panel.activeTab),k=l(()=>T.value[d.value]===ne.NODE_REPOSITORY),f=l(()=>t.state.panel.isExtensionPanelOpen);le(f,R=>{R||setTimeout(()=>{t.commit("nodeRepository/setSelectedNode",null)},tt)}),ie(()=>{t.dispatch("application/subscribeToNodeRepositoryLoadingEvent"),s.value.length||t.dispatch("nodeRepository/getAllNodes",{append:!1})});const v=({isSelected:R,nodeTemplate:C})=>{if(!R||!f.value){t.dispatch("panel/openExtensionPanel"),t.commit("nodeRepository/setSelectedNode",C);return}t.dispatch("panel/closeExtensionPanel")},b=()=>{U.desktop.openWebUIPreferencePage()};return(R,C)=>{const F=h("Portal");return o(),u("div",et,[p(Xe),n.value?(o(),u(A,{key:0},[c.value?(o(),r(ge,{key:0,ref:"searchResults","display-mode":i.value,onShowNodeDescription:v,onOpenPreferences:b},null,8,["display-mode"])):(o(),r(we,{key:1,"display-mode":i.value,onShowNodeDescription:v},null,8,["display-mode"]))],64)):(o(),r(de,{key:1,progress:m.value?.progress,"extension-name":m.value?.extensionName},null,8,["progress","extension-name"])),f.value&&k.value?(o(),r(F,{key:2,to:"extension-panel"},{default:y(()=>[p(re,{name:"extension-panel"},{default:y(()=>[p(ce,{"show-close-button":"","selected-node":a.value?_.value:null,onClose:C[0]||(C[0]=st=>S(t).dispatch("panel/closeExtensionPanel"))},null,8,["selected-node"])]),_:1})]),_:1})):w("",!0)])}}});const pt=N(ot,[["__scopeId","data-v-43451447"]]);export{pt as default};
